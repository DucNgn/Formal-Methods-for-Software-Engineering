\newpage
\section{Problem 2: Class Contacts (35 pts)}

\subsection{Description:}
Define a formal specification in Object-Z for class \textit{Contacts} whose interface contains the
following \textit{robust specifications}:

\begin{itemize}
    \item \textbf{MakeNewContact}: Adds a new person to Contacts with a single phone number.
    \item \textbf{AddNumber}: Adds an additional phone number for an existing contact.
    \item \textbf{SearchForNumber}: : Returns a collection of phone numbers for a given person.
    \item \textbf{DeleteNumber}: Deletes an existing number.
\end{itemize}

\subsection{Answer:}

\begin{class}{Contacts}
\also
\upharpoonright (MakeNewContact, AddNumber, SearchForNumber, DeleteNumber) \\
\begin{state}
numbers: \mathbb{P} PhoneNumberType\\
recorded : PhoneNumberType \pfun NameType\\
\where
numbers = dom~recorded
\end{state} \\
% INIT SECTION %
\begin{init}
recorded = \emptyset %\{ \}
\end{init} \\
% MakeNewContactOK  SECTION%
\begin{op}{MakeNewContactOK}
\Delta (recorded, numbers) \\
number?: PhoneNumberType \\
name?: NameType \\
\ST
number? \notin numbers \\
name? \notin ran~recorded \\
recorded' = recorded \cup \{number? \mapsto name? \}\\
numbers' = numbers \cup \{number?\} \\
\end{op}\\
% AddNumberOK SECTION %
\begin{op}{AddNumberOK}
\Delta (recorded, numbers) \\
number?: PhoneNumberType \\
name?: NameType
\ST
number? \notin numbers \\
name? \in ran~recorded \\
recorded' = recorded \cup \{number? \mapsto name?\} \\
numbers' = numbers \cup \{number?\} \\
\end{op}\\
\begin{op}{SearchForNumberOK}
    \Xi (recorded) \\
    name? : NameType\\
    number! : \mathbb{P} PhoneNumberType
    \ST
    name? \in ran~recorded\\
    number! = \{x:numbers  \mid recorded(x) = name?\}
\end{op}\\
\begin{op}{DeleteNumberOK}
\Delta () \\
\ST
\end{op}\\
\begin{op}{Success}
response!: Message \\
\ST
response! = 'ok'
\end{op}\\
\begin{op}{NumberExists}
number?: PhoneNumberType \\
response!: Message \\
\ST
number? \in numbers \\
response! = 'Number~already~exists'
\end{op}\\
\zbreak
\begin{op}{NameExists}
name?: NameType \\
response!: Message \\
\ST
name? \in ran~recorded \\
response! = 'Name~already~taken'
\end{op}\\
\also
MakeNewContact \sdef (MakeNewContactOK \wedge Success) \oplus (NumberExists \lor NameExists) \\
SearchForNumber \sdef \\
\begin{op}{NameNotFound}
    name?: NameType \\
    response!: Message \\
    \ST
    name? \notin ran~recorded \\
    response! = 'Name~not~found'
\end{op}\\
\also
MakeNewContact \sdef (MakeNewContactOK \wedge Success) \oplus (NumberExists \lor NameExists) \\
AddNumber \sdef (AddNumberOK \wedge Success) \oplus (NumberExists \lor NameNotFound) \\
SearchForNumber \sdef (SearchForNumberOK \wedge Success) \oplus NameNotFound \\
DeleteNumber \sdef
\end{class}
