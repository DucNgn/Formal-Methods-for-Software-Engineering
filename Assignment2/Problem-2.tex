\newpage
\section{Problem 2: Class Contacts (35 pts)}

\subsection{Description:}
Define a formal specification in Object-Z for class \textit{Contacts} whose interface contains the
following \textit{robust specifications}:

\begin{itemize}
    \item \textbf{MakeNewContact}: Adds a new person to Contacts with a single phone number.
    \item \textbf{AddNumber}: Adds an additional phone number for an existing contact.
    \item \textbf{SearchForNumber}: : Returns a collection of phone numbers for a given person.
    \item \textbf{DeleteNumber}: Deletes an existing number.
\end{itemize}

\subsection{Answer:}

\begin{class}{Contacts}
\also
\upharpoonright (MakeNewContact, AddNumber, SearchForNumber, DeleteNumber) \\
\begin{state}
numbers: \mathbb{P} PhoneNumberType\\
recorded : PhoneNumberType \pfun NameType\\
\where
numbers = dom~recorded
\end{state} \\
\begin{init}
recorded = \emptyset %\{ \}
\end{init} \\
\begin{op}{MakeNewContactOK}
\Delta (recorded) \\
number?: PhoneNumberType \\
name?: NameType \\
\ST
number? \notin numbers \\
name? \notin ran~recorded \\
recorded' = recorded \cup \{number? \mapsto name? \}
\end{op}\\
\begin{op}{AddNumberOK}
\Delta () \\
\ST
\end{op}\\
\begin{op}{SearchForNumberOK}
    \Xi (recorded) \\
    name? : NameType\\
    number! : \mathbb{P} PhoneNumberType
    \ST
    name? \in ran~recorded\\
    number! = \{x:numbers  \mid recorded(x) = name?\}
\end{op}\\
\begin{op}{DeleteNumberOK}
\Delta (recorded) \\
number? : PhoneNumberType\\
\ST
number? \in ran~recorded\\
recorded' = recorded \ndres \{name? \mapsto number?  \}
\end{op}\\
\begin{op}{Success}
response!: Message \\
\ST
response! = 'Success'
\end{op}\\
\begin{op}{Error}
response!: Message\\
\ST
response! =  'Error'\\
\end{op}\\
\zbreak
\begin{op}{NumberExists}
number?: PhoneNumberType \\
response!: Message \\
\ST
number? \in numbers \\
response! = 'Number~already~exists'
\end{op}\\
\begin{op}{NumberNotFound}
number?: PhoneNumberType \\
response!: Message \\
\ST
number? \notin numbers \\
response! = 'Number~not~found'
\end{op}\\
\begin{op}{NameExists}
name?: NameType \\
response!: Message \\
\ST
name? \in ran~recorded \\
response! = 'Name~already~taken'
\end{op}\\
\begin{op}{NameNotFound}
    name?: NameType \\
    response!: Message \\
    \ST
    name? \notin ran~recorded \\
    response! = 'Name~not~found'
\end{op}\\
\also
MakeNewContact \sdef (MakeNewContactOK \wedge Success) \oplus (NumberExists \lor NameExists) \\
AddNumber \sdef \\
SearchForNumber \sdef (SearchForNumberOK \wedge Success) \oplus NameNotFound \\
DeleteNumber \sdef (DeleteNumberOK \wedge Success ) \oplus NumberNotFound  \\
\end{class}